{% extends 'hr_dashboard/base.html' %}

{% block title %}HR Manager Dashboard - HR Wallet{% endblock %}
{% block page_title %}HR Manager Dashboard{% endblock %}

{% block content %}
<!-- Welcome Section -->
<div class="row mb-4">
    <div class="col-12">
        <div class="card bg-info text-white">
            <div class="card-body">
                <h2 class="mb-1">Welcome, {{ user.get_full_name|default:user.username }}!</h2>
                <p class="mb-0">HR Manager - Employee Management & Operations</p>
            </div>
        </div>
    </div>
</div>

<!-- Statistics Cards -->
<div class="row mb-4">
    <div class="col-md-3 mb-3">
        <div class="card stats-card">
            <div class="card-body text-center">
                <i class="bi bi-people display-4 mb-3"></i>
                <h3 class="mb-1">{{ total_employees|default:"0" }}</h3>
                <p class="mb-0">Active Employees</p>
            </div>
        </div>
    </div>
    <div class="col-md-3 mb-3">
        <div class="card bg-success text-white">
            <div class="card-body text-center">
                <i class="bi bi-building display-4 mb-3"></i>
                <h3 class="mb-1">{{ total_departments|default:"0" }}</h3>
                <p class="mb-0">Departments</p>
            </div>
        </div>
    </div>
    <div class="col-md-3 mb-3">
        <div class="card bg-warning text-white">
            <div class="card-body text-center">
                <i class="bi bi-calendar-event display-4 mb-3"></i>
                <h3 class="mb-1">{{ pending_leaves|default:"0" }}</h3>
                <p class="mb-0">Pending Leaves</p>
            </div>
        </div>
    </div>
    <div class="col-md-3 mb-3">
        <div class="card bg-primary text-white">
            <div class="card-body text-center">
                <i class="bi bi-clock display-4 mb-3"></i>
                <h3 class="mb-1">{{ employees_present_today|default:"0" }}</h3>
                <p class="mb-0">Present Today</p>
            </div>
        </div>
    </div>
</div>

<!-- Quick Actions -->
<div class="row mb-4">
    <div class="col-12">
        <div class="card">
            <div class="card-header">
                <h5 class="mb-0">
                    <i class="bi bi-lightning-charge me-2"></i>
                    Quick Actions
                </h5>
            </div>
            <div class="card-body">
                <div class="row">
                    <div class="col-md-3 mb-3">
                        <a href="{% url 'hr_dashboard:hr_employees' %}" class="btn btn-info w-100 py-3">
                            <i class="bi bi-person-plus display-6 d-block mb-2"></i>
                            Manage Employees
                        </a>
                    </div>
                    <div class="col-md-3 mb-3">
                        <a href="{% url 'hr_dashboard:hr_leave_approvals' %}" class="btn btn-outline-warning w-100 py-3">
                            <i class="bi bi-calendar-check display-6 d-block mb-2"></i>
                            Approve Leaves
                        </a>
                    </div>
                    <div class="col-md-3 mb-3">
                        <a href="{% url 'hr_dashboard:hr_attendance' %}" class="btn btn-outline-primary w-100 py-3">
                            <i class="bi bi-clock display-6 d-block mb-2"></i>
                            View Attendance
                        </a>
                    </div>
                    <div class="col-md-3 mb-3">
                        <a href="/admin/" class="btn btn-outline-secondary w-100 py-3">
                            <i class="bi bi-gear display-6 d-block mb-2"></i>
                            Admin Panel
                        </a>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Recent Activity -->
<div class="row">
    <div class="col-md-6 mb-4">
        <div class="card h-100">
            <div class="card-header">
                <h5 class="mb-0">
                    <i class="bi bi-clock-history me-2"></i>
                    Recent Leave Requests
                </h5>
            </div>
            <div class="card-body">
                <div class="list-group list-group-flush">
                    {% for leave in recent_leave_requests %}
                    <div class="list-group-item d-flex justify-content-between align-items-start">
                        <div class="ms-2 me-auto">
                            <div class="fw-bold">{{ leave.employee.user.get_full_name }}</div>
                            <small class="text-muted">{{ leave.leave_type|title }} - {{ leave.days_requested }} days</small>
                        </div>
                        <span class="badge bg-warning rounded-pill">{{ leave.status|title }}</span>
                    </div>
                    {% empty %}
                    <div class="list-group-item">
                        <small class="text-muted">No recent leave requests</small>
                    </div>
                    {% endfor %}
                </div>
                <div class="text-center mt-3">
                    <a href="{% url 'hr_dashboard:hr_leave_approvals' %}" class="btn btn-outline-primary btn-sm">View All Requests</a>
                </div>
            </div>
        </div>
    </div>
    
    <div class="col-md-6 mb-4">
        <div class="card h-100">
            <div class="card-header">
                <h5 class="mb-0">
                    <i class="bi bi-person-plus me-2"></i>
                    Recent Employees
                </h5>
            </div>
            <div class="card-body">
                <div class="list-group list-group-flush">
                    {% for employee in recent_employees %}
                    <div class="list-group-item d-flex justify-content-between align-items-start">
                        <div class="ms-2 me-auto">
                            <div class="fw-bold">{{ employee.user.get_full_name }}</div>
                            <small class="text-muted">{{ employee.job_title }} - {{ employee.department.name }}</small>
                        </div>
                        <small class="text-muted">{{ employee.hire_date|date:"M d" }}</small>
                    </div>
                    {% empty %}
                    <div class="list-group-item">
                        <small class="text-muted">No recent employees</small>
                    </div>
                    {% endfor %}
                </div>
                <div class="text-center mt-3">
                    <a href="{% url 'hr_dashboard:hr_employees' %}" class="btn btn-outline-primary btn-sm">View All Employees</a>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}
